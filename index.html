<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ChipCheck</title>
    <!-- Google Fonts: Outfit and Rajdhani -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600&family=Rajdhani:wght@500;700&display=swap"
        rel="stylesheet">
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <link rel="stylesheet" href="style.css">
</head>

<body>

    <!-- Background Ambience -->
    <div class="background-effects">
        <!-- Suits -->
        <div class="suit s1">‚ô†</div>
        <div class="suit s2">‚ô•</div>
        <div class="suit s3">‚ô£</div>
        <div class="suit s4">‚ô¶</div>
        <div class="suit s5">‚ô†</div>
        <div class="suit s6">‚ô•</div>
        <div class="suit s7">‚ô£</div>
        <div class="suit s8">‚ô¶</div>

        <!-- Phrases -->
        <div class="phrase p1">ALL IN</div>
        <div class="phrase p2">BLUFF</div>
        <div class="phrase p3">ROYAL FLUSH</div>
        <div class="phrase p4">FOLD</div>
        <div class="phrase p5">THE NUTS</div>

        <!-- Floating Cards -->
        <div class="float-card fc1">A‚ô†</div>
        <div class="float-card fc2">K‚ô•</div>
        <div class="float-card fc3">Q‚ô¶</div>
        <div class="float-card fc4">J‚ô£</div>

        <!-- Chips -->
        <div class="chip c1"></div>
        <div class="chip c2"></div>
        <div class="chip c3"></div>
        <div id="pokerQuote" class="poker-quote">"You will show your poker greatness by the hands you fold, not the
            hands you play."</div>
    </div>

    <main class="container">
        <!-- Persistent Header -->
        <header class="game-header">
            <div id="liveClock" class="session-info">--:--</div>
            <h1 class="neon-title">ChipCheck</h1>
            <p class="subtitle">Poker Night Tracker</p>
            <div id="sessionConfigDisplay" style="color: var(--neon-cyan); font-size: 0.8rem; margin-top: 5px;"></div>
        </header>

        <!-- Sticky Game Status Bar (Hidden by default) -->
        <div id="stickyStatusBar" class="sticky-bar hidden">
            <div class="sb-item">üí∞ Pot: <span id="sbPot">‚Çπ0</span></div>
            <div class="sb-item">üë§ Players: <span id="sbCount">0</span></div>
            <div class="sb-item">‚è±Ô∏è Time: <span id="sbTimer">00:00</span></div>
        </div>

        <!-- Setup Session Section -->
        <section id="setupSection" class="game-card">
            <h2 class="neon-title" style="font-size: 2rem; margin-bottom: 20px;">
                Setup Session</h2>

            <div class="template-controls" style="display: flex; gap: 10px; margin-bottom: 20px;">
                <select id="templateSelect"
                    style="flex-grow: 1; padding: 10px; background: rgba(0,0,0,0.3); color: white; border: 1px solid rgba(255,255,255,0.1); border-radius: 8px;">
                    <option value=""> Load Preset </option>
                </select>
                <button id="saveTemplateBtn" class="cyber-btn"
                    style="width: auto; margin:0; padding: 10px 15px; font-size: 0.9rem;">Save</button>
                <button id="deleteTemplateBtn" class="cyber-btn danger-btn"
                    style="width: auto; margin:0; padding: 10px 15px; font-size: 0.9rem;"
                    title="Delete Selected Preset">Delete</button>
            </div>

            <div class="input-group">
                <label
                    style="color: var(--text-muted); font-size: 0.9rem; margin-bottom: 5px; display: block; text-align: left;">
                    SESSION NAME
                </label>
                <input type="text" id="sessionNameInput" placeholder="e.g. Friday Night Poker">
            </div>

            <div class="input-group">
                <label
                    style="color: var(--text-muted); font-size: 0.9rem; margin-bottom: 5px; display: block; text-align: left;">
                    LOCATION
                </label>
                <input type="text" id="locationInput" placeholder="e.g. John's House">
            </div>

            <div class="input-group">
                <label
                    style="color: var(--text-muted); font-size: 0.9rem; margin-bottom: 5px; display: block; text-align: left;">
                    SESSION BUY-IN (‚Çπ)
                </label>
                <input type="number" id="sessionBuyInInput" value="500" placeholder="e.g. 500">
            </div>

            <div class="input-group">
                <label
                    style="color: var(--text-muted); font-size: 0.9rem; margin-bottom: 5px; display: block; text-align: left;">
                    CHIP DENOMINATIONS
                </label>
                <input type="text" id="chipDenomsInput" value="10, 25, 50, 100, 500" placeholder="e.g. 10, 50, 100">
            </div>

            <div class="input-group" style="display: flex; align-items: center; gap: 10px; margin-bottom: 1.5rem;">
                <input type="checkbox" id="runningBalanceInput" style="width: 20px; height: 20px;">
                <label for="runningBalanceInput" style="color: white; font-size: 0.95rem; cursor: pointer;">
                    Cumulative Running Balance ?
                </label>
            </div>

            <button class="cyber-btn" onclick="startSession()">
                <span class="btn-content">Start Poker Night</span>
                <span class="glitch-effect"></span>
            </button>
            <button class="text-btn" id="demoModeBtn"
                style="margin-top: 29px; font-size: 0.9rem; color: var(--neon-cyan);">Run Demo Mode</button>
        </section>
        </section>

        <!-- Main Game Interface (Hidden initially) -->
        <div id="gameInterface" class="hidden">
            <section class="game-card">
                <h2 class="neon-title" style="font-size: 2rem; margin-bottom: 20px;">Players</h2>

                <div class="input-group">
                    <input type="text" id="playerName" placeholder="PLAYER NAME" autocomplete="off">
                    <span class="focus-border"></span>
                </div>
                <button class="cyber-btn" onclick="addBuyIn()">
                    <span class="btn-content">Add Player / Buy-In</span>
                    <span class="glitch-effect"></span>
                </button>
            </section>

            <section class="stats-panel">
                <h2>Total Pot</h2>
                <div id="totalDisplay" class="total-amount">‚Çπ0</div>
            </section>

            <section class="player-roster">
                <h3>Active Players</h3>
                <div id="playerList" class="player-list"></div>
            </section>

            <button class="cyber-btn danger-btn" onclick="endSession()">End Session</button>
            <button class="text-btn" onclick="toggleHistory()">Past Sessions</button>
        </div>
    </main>



    <!-- Summary Modal -->
    <div id="summaryModal" class="modal hidden">
        <div class="modal-content" id="summaryContent">
            <h2 class="neon-title" style="margin-bottom: 1rem;">Game Over</h2>

            <div class="awards">
                <div class="award shark">
                    <div class="emoji">üèÜ</div>
                    <h3>Shark of the Night</h3>
                    <div id="sharkName">-</div>
                    <div id="sharkAmount" class="profit">‚Çπ0</div>
                </div>
                <div class="award atm">
                    <div class="emoji">üíÄ</div>
                    <h3>ATM Machine</h3>
                    <div id="atmName">-</div>
                    <div id="atmAmount" class="loss">‚Çπ0</div>
                </div>
            </div>

            <div class="game-card" style="margin-top: 1rem; padding: 1rem;">
                <h3>Performance</h3>
                <div id="analyticsChart" class="chart-container"></div>
            </div>

            <div class="game-card" style="padding: 1rem;">
                <h3>Settlements</h3>
                <div id="settlementList" class="settlement-list"></div>
            </div>

            <div class="game-card" style="padding: 1rem;">
                <h3>Detailed Results</h3>
                <div class="summary-header">
                    <span>NAME</span>
                    <span style="text-align:center;">BUY-INS</span>
                    <span style="text-align:right;">P/L</span>
                </div>
                <div id="summaryList" class="summary-list"></div>
            </div>

            <div class="game-card" style="padding: 1rem;">
                <h3>Pending Settlements</h3>
                <textarea id="pendingSettlements" placeholder="Add custom notes here..." rows="4"
                    style="width:100%; background:rgba(0,0,0,0.3); color:white; border:1px solid rgba(255,255,255,0.1); padding:10px; border-radius:8px;"></textarea>
            </div>

            <div id="summaryActions" class="modal-actions"
                style="display: flex; gap: 10px; justify-content: center; margin-top: 1.5rem; margin-bottom: 2rem;">
                <button class="cyber-btn" onclick="shareResults()">üì§ Share</button>
                <button class="cyber-btn" onclick="downloadSummary()">üì∏ Save Image</button>
                <button class="cyber-btn" onclick="restartApp()"
                    style="background: transparent; border: 1px solid rgba(255,255,255,0.2);">New Session</button>
            </div>
        </div>
    </div>

    <!-- History Modal -->
    <div id="historyModal" class="modal hidden">
        <div class="modal-content">
            <h2>Past Sessions</h2>
            <div id="historyList" class="history-list"></div>
            <div class="modal-actions" style="margin-top: 1rem; display: flex; gap: 10px; justify-content: center;">
                <button class="cyber-btn danger-btn" onclick="clearHistory()" style="margin-top:0;">üóëÔ∏è Clear</button>
                <button class="cyber-btn" onclick="toggleHistory()" style="margin-top:0;">Close</button>
            </div>
        </div>
    </div>

    <script src="script.js" defer></script>
</body>

</html>
